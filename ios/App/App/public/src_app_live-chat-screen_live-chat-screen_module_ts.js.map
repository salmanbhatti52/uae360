{"version":3,"file":"src_app_live-chat-screen_live-chat-screen_module_ts.js","mappings":"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","sources":["./src/app/live-chat-screen/live-chat-screen-routing.module.ts","./src/app/live-chat-screen/live-chat-screen.module.ts","./src/app/live-chat-screen/live-chat-screen.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LiveChatScreenPage } from './live-chat-screen.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LiveChatScreenPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LiveChatScreenPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LiveChatScreenPageRoutingModule } from './live-chat-screen-routing.module';\n\nimport { LiveChatScreenPage } from './live-chat-screen.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LiveChatScreenPageRoutingModule\n  ],\n  declarations: [LiveChatScreenPage]\n})\nexport class LiveChatScreenPageModule {}\n","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { CheckUserService } from '../check-user.service';\nimport { ApiService } from '../services/api.service';\nimport { ActivatedRoute } from '@angular/router';\nimport { IonContent, IonTextarea } from '@ionic/angular';\n\n@Component({\n  selector: 'app-live-chat-screen',\n  templateUrl: './live-chat-screen.page.html',\n  styleUrls: ['./live-chat-screen.page.scss'],\n})\nexport class LiveChatScreenPage implements OnInit {\n  @ViewChild(IonContent) content: IonContent; \n  @ViewChild(IonTextarea) textarea: IonTextarea; \n  selectedAdmin:any;\n  interval:any;\n  messages: any;\n  previousMsgsCount: any;\n  NewMsgsCount: any;\n  constructor(public location:Location,\n    public checkUser:CheckUserService,\n    public api:ApiService,\n    public activatedRoute:ActivatedRoute\n    ) { }\n\n  ngOnInit() {\n    this.selectedAdmin = this.activatedRoute.snapshot.params['selected_admin'];\n    console.log(\"Selected Admin: \",this.selectedAdmin);\n    this.getMessagesLive();\n    this.updateMessagesLive();\n  }\n\n  ionViewWillEnter(){\n    this.interval = setInterval(() => {\n      this.getMessagesLiveAgain();\n      // this.updateMessagesLive();\n    },3000);\n     \n  }\n\n  ionViewWillLeave(){\n    clearInterval(this.interval);\n    console.log('leave view');\n  }\n\n  scrollToBottom(){\n    this.content.scrollToBottom(0);\n  }\n\n  getMessagesLive(){\n    let data ={\n      requestType:\"getMessages\",\n      userId:this.checkUser.appUserId,\n      otherUserId:this.selectedAdmin\n    }\n    this.api.showLoading();\n    this.api.sendRequest(\"ChatLive\",data).subscribe((res:any)=>{\n      this.api.hideLoading();\n      console.log(\"Resposne: \",res);\n      if(res.status == 'success'){\n        this.messages = res.data;\n        this.previousMsgsCount = res.data.length\n        this.scrollToBottom();\n      }\n\n    },(err)=>{\n      this.api.hideLoading();\n      console.log(\"Api Error: \",err);\n      \n    })\n  }\n\n  getMessagesLiveAgain(){\n    let data ={\n      requestType:\"getMessages\",\n      userId:this.checkUser.appUserId,\n      otherUserId:this.selectedAdmin\n    }\n    this.api.sendRequest(\"ChatLive\",data).subscribe((res:any)=>{\n      console.log(\"Resposne: \",res);\n      if(res.status == 'success'){\n        this.messages = res.data;\n        this.NewMsgsCount = res.data.length;\n        if(this.previousMsgsCount < this.NewMsgsCount){\n          this.scrollToBottom();\n          this.previousMsgsCount = this.NewMsgsCount\n        }\n      }\n\n    },(err)=>{\n      console.log(\"Api Error: \",err);\n      \n    })\n  }\n  updateMessagesLive(){\n    let data ={\n      requestType:\"updateMessages\",\n      userId:this.checkUser.appUserId,\n      otherUserId:this.selectedAdmin\n    }\n    this.api.sendRequest(\"ChatLive\",data).subscribe((res:any)=>{\n      console.log(\"Resposne: \",res);\n      if(res.status == 'success'){\n        console.log(\"Message updated.\");\n        this.scrollToBottom();\n      }\n\n    },(err)=>{\n      console.log(\"Api Error: \",err);\n      \n    })\n  }\n\n  sendMessagesLive(message){\n    console.log(\"Message: \",message);\n    \n    let data ={\n      requestType:\"sendMessage\",\n      sender_type:\"Users\",\n      userId:this.checkUser.appUserId,\n      otherUserId:this.selectedAdmin,\n      content:message,\n      messageType:\"1\"\n    }\n    this.api.sendRequest(\"ChatLive\",data).subscribe((res:any)=>{\n      console.log(\"Resposne: \",res);\n      if(res.status == 'success'){\n        this.getMessagesLive();\n      }\n\n    },(err)=>{\n      console.log(\"Api Error: \",err);\n      \n    })\n    this.textarea.value = '';\n  }\n\n\n  goBack(){\n    this.location.back();\n  }\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}